\section{Traffic Characterization of Peer-to-Peer Networks}\label{sec:aslevel:p2p}

%Problem statement:
In order to evaluate the transit costs produced by overlay networks we characterize the traffic of the largest P2P network BitTorrent on AS-Level.
This helps us to estimate the potential to reduce inter-domain traffic produced by overlay networks and to develop traffic optimization mechanisms.
These mechanisms can also be applied to the overlay networks used in hierarchical CDNs.
%Our methodology:
To model the BitTorrent traffic flow across ISPs in the Internet, we use measurements of live BitTorrent swarms and the actual AS topology of the Internet provided by Caida.org. Thus, we estimate BitTorrent traffic characteristics and the emerging transit costs.
% The measurements of live BitTorrent swarms contain the location of peers in the Internet, i.e., AS numbers, for a very large set of swarms \cite{Hossfeld2011}.
% The dataset from Caida.org contains a full AS graph derived from RouteViews BGP table snapshots, including the AS relations. We infer AS paths based on this dataset with the algorithm published in \cite{yang2009efficient}.
%Thus, we get the real Internet AS topology.
% We use the inferred AS paths to calculate the real AS paths between peers in BitTorrent swarms.
In addition, we define peer selection strategies that decide which peer in a swarm is connected to which other peer and we estimate the transit costs for these strategies.
This helps us to assess the optimization potential of overlay networks and the revenue of ISPs transit services.
%(a) The random selection strategy is applied to peer selection of today's BitTorrent clients. (b) The locality aware selection strategy connects to the peers with shortest AS paths, to reduce AS hops and potentially latencies in the BitTorrent network. (c) The selfish-ISP selection connects peers preferentially to peers in the ISPs customer tree in order to maximize its revenue. The locality aware and selfish-ISP selection strategies are motivated by the optimization potential of the BitTorrent overlay network, as in \cite{Hossfeld2011}, and the optimization potential of the revenue of ISPs transit services, respectively.
% These definitions are the approximative part of the work. We define three connection strategies that calculate which peer in a swarm is connected to which other peer and we estimate the transit costs for these strategies.

%Our contribution: We answer the following questions.
% The contribution of this section is two-fold.
% First, our results show how BitTorrent networks are distributed over the Internet. We find that almost none of the peers are located in \tier ASs which means that \tier ASs are not able to control BitTorrent swarms by directly accessing the peers. We analyze the amount of BitTorrent traffic each AS forwards with BitTorrent random peer selection. From our results we derive that most traffic is forwarded by \tier ASs on a per AS basis, whereas the BitTorrent traffic aggregated over all large ISPs is significantly higher. As second contribution, we analyze the potential to optimize the BitTorrent overlay by using the shortest AS paths. We find that in about \unit[15]{\%} of the investigated swarms, peers exist who can exchange data locally in the same AS.
%The locality peer selection doubles this amount of locally generated traffic compared to the other selection strategies.
%Furthermore, shorter AS paths are derived with locality selection.
% Furthermore, the AS path length has a median of two AS hops for random selection whereas AS paths have two or less AS hops in \unit[80]{\%} with the locality selection strategy. The inter-AS traffic is reduced especially in \tier and in large ISPs by locality aware peer selection. Finally, we estimate the potential of ISPs to optimize their revenue. We find that \tier ASs loose a lot of revenue if locality or selfish-ISP selection is used, since they are avoided as provider. Small ISPs and stub ASs have large benefits from using locality, since they can minimize their costs. This implies less revenues at \tier and large ISPs. Large ISPs have to use selfish-ISP selection to have a higher prospect on profit.

%structure
The applied methodology to characterize BitTorrent traffic and to estimate transit costs is described in \refsec{sec:p2p:methodology}. In \refsec{sec:p2p:results} we describe the numerical examples of this study and their importance for ISPs.

\input{aslevel/p2p/methodology/methodology}
\input{aslevel/p2p/results/results}
