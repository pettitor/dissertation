\section{Statistical Characterization of the Distribution of IP Addresses on Autonomous Systems}\label{sec:aslevel:census}

The performance of systems using CPE or resources provided by end-users depend on the capacity and number of devices available.
To assess the potential of a hierarchical cache system in an ISPs network, the number of active subscribers in an autonomous systems has to be known.
Assuming that the number of active IP-addresses is correlated to the number of subscribers in an autonomous system, we use the Internet Census Dataset to determine the distribution of active IP-addresses on autonomous systems.

We use the Internet Census Dataset \cite{carna2013} to determine the number of active IP-addresses for each AS in the Internet.
The Internet Census Dataset provides a scan on the active IP addresses in the Internet based on a full probing of the entire IPv4 Internet.
%The Internet Census Dataset\cite{carna2013} was conducted from June to October 2012.
The scan was conducted from June to October 2012 by infecting several hundred thousand unprotected devices on the Internet to form the so called \emph{carna} botnet.
The botnet functioned as distributed port scanner that transfered the results to a central server.

%The complete IPv4-address room was scanned using a bot-net consisting of 4,200,000 nodes.
In the ICMP ping scan more than 420 million replied to requests more than once.
The service probe data reveal open ports on devices which is used to infer the type of device.
The Internet Census Dataset was validated forensically in \cite{dainotticaida} by aligning the probes of the botnet with the traffic captured at the UCSD Network Telescope \cite{ucsdtelescope}, which is a large darknet, i.e., IP addresses that are inactive, thus not accepting connections.
The raw logs of the carna botnet erroneously reported that a large number of IPs in the darknet were active, likely due to the presence of HTTP proxies.
However, according to \cite{dainotticaida}, only about 3\% of the host probe and port scan logs are potentially affected by this problem.
Unaffected by this issue are the logs based on ICMP pings and actual responses from the target hosts, which are used in our study.
In \cite{krenc2014internet} the scope of the dataset is taken into perspective and show that, although there are some qualitative problems, the measurement data seems to be authentic.
%We use the Internet Census Dataset to determine the number of active IP-addresses for each autonomous system in the Internet.

We use an IP to ASN mapping to derive the autonomous system number for each IP-address. There are different services, that provide an IP to ASN mapping.
The whois-service can be used to get the current ASN for an IP-address.
To enable an efficient evaluation we used the MAXMIND GeoLite ASN database \cite{geo_ip}, which is updated every month and can be downloaded and used as a local database.
The results of the MAXMIND GeoLite ASN database were cross checked with results obtained from whois, which showed no differences.

The ICMP ping scan discovered a total of 598,180,914 IP-addresses.
The service probe scan discovered 244,000 IP-addresses that listen to port 9100 and are identified as print servers, and 70.84 million IP-addresses of web-servers that listen to port 80.
Assuming that most network functions do not reply to ICMP ping requests and neglecting different network functions, this results in 88.1\% of IP-addresses assigned to end-user devices.
Since the Internet Census the number of Internet users increased, which also has to be considered.
According to \cite{itu2015facts} there is a 7\% annual increase in fixed-broadband subscriptions in the past three years.
%From 2012 to 2014 the number of Internet users increased by almost 500,000,000 according to \cite{â€¢}.

% \begin{figure}[tb]
% \centering
% \includegraphics[width=0.49\textwidth]{aslevel/census/figs/shareactiveIPs}
% \caption{Cumulative share of active IP-addresses in autonmous systems ranked in descending order.}
% \label{fig:shareactiveIPs}
% \end{figure}
%
% \begin{figure}[tb]
% \centering
% \includegraphics[width=0.49\textwidth]{aslevel/census/figs/activeIPs}
% \caption{Rank of Internet providers with number of active IP-addresses per AS.}
% \label{fig:asrank}
% \end{figure}

\begin{figure*}[bt]
\begin{minipage}[b]{0.49\textwidth}
  \centering
  \includegraphics[width=1\textwidth]{aslevel/census/figs/shareactiveIPs}
  \caption{Cumulative share of active IPs in autonmous systems ranked in descending order.}
  \label{fig:shareactiveIPs}
\end{minipage}
\hspace{0.01\textwidth}
\begin{minipage}[b]{0.49\textwidth}
  \centering
  \includegraphics[width=\textwidth]{aslevel/census/figs/activeIPs}
  \caption{Rank of Internet providers with number of active IPs per AS.}
  \label{fig:asrank}
\end{minipage}
\end{figure*}

\reffig{fig:shareactiveIPs} shows the cumulative share of active IP-addresses in the autonomous systems ranked in descending order.
The 100 largest autonomous systems make up 2/3 of active IPs and more than 85\% of the IPs are active in only 1\% of the autonomous systems. The 10 largest autonomous systems already contain 30\% of the active IPs.

\reffig{fig:asrank} shows the number of active IP-addresses per AS ranked in descending order.
The top 5 ASs are shown in table~\ref{tab:asrank}.
The AS with most active IP-addresses is ChinaTelecom with almost 60 million active IPs, followed by another Chinese provider.
The largest AS in the US is Comcast on rank three.
The largest Korean and German providers are ranked 4 and 5 with more than 18 million active IPs.
The number of active IP addresses can be approximated with a power law with slope 1.5 that drops a little for low ranks.
This shows that the distribution of active IP addresses on ASs is highly heterogeneous.
That means the potential of approaches leveraging spare resources on home routers depends on the AS.

\begin{table}[tb]
\centering
\caption{Rank of top 5 provider with most active IP-addresses.}
\label{tab:asrank}
\begin{tabular}{|c|c|c|c|}
\hline
rank r & ASN & provider & \# active IPs  \\
\hline
1 & 4134 & ChinaTelecom & 59,824,824 \\
2 & 4837 & China-Network-Communication-Group & 27,776,643 \\
3 & 7922 & Comcast & 20,227,918 \\
4 & 4766 & KoreaTelecom & 18,502,963 \\
5 & 3320 & DeutscheTelekomAG & 18,476,519 \\
\hline
\end{tabular}
\end{table}
%

%\input{aslevel/census/dataset/dataset}
%\input{aslevel/census/evaluation/evaluation}
%\input{aslevel/census/potential/potential}
